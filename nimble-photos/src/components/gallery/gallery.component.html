<main class="gallery-panel flex flex-1 flex-col overflow-hidden relative h-full">
  <div class="gallery-viewport flex-1 min-h-0 relative">
    <div class="scroll-container px-4 py-6" (scroll)="onScroll($event)">
      <div class="masonry-grid">
        @for (photo of photos(); track photo.id) {
        <article [routerLink]="['/photo', photo.id]" class="photo-card cursor-pointer">
          <div class="photo-visual">
            <img [src]="getImageUrl(photo)" [alt]="photo.name" />
          </div>
          <div class="photo-content px-3 pb-4">
            <p class="photo-title text-lg leading-tight mb-1">{{ photo.name }}</p>
            <div class="photo-meta flex flex-wrap gap-2 text-[0.65rem] tracking-wider uppercase text-slate-400 font-medium">
              <span>{{ photo.dateTaken ? (photo.dateTaken | date:'mediumDate') : 'Unknown date' }}</span>
              <span *ngIf="photo.format">{{ photo.format.toUpperCase() }}</span>
              <span>{{ formatBytes(photo.size) }}</span>
            </div>
            <div class="photo-meta flex flex-wrap gap-2 text-[0.65rem] tracking-wider uppercase text-slate-400 font-medium mt-1">
              <span *ngIf="photo.width && photo.height">{{ photo.width }} x {{ photo.height }}</span>
              <span *ngIf="photo.thumbnailWidth && photo.thumbnailHeight">{{ photo.thumbnailWidth }} x {{ photo.thumbnailHeight }} thumbnail</span>
              <span *ngIf="photo.metadata?.location">{{ photo.metadata?.location }}</span>
            </div>
          </div>
        </article>
        }
      </div>

      <div class="gallery-status flex justify-center py-8 text-sm text-slate-500 font-medium tracking-wide">
        @if (isFetching()) {
        <span class="animate-pulse">Loading more art...</span>
        }
        @if (!isFetching() && photos().length > 0) {
        <span>End of stream</span>
        }
      </div>
    </div>
  </div>
</main>
